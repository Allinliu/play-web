#{extends 'Web/layout-with-menu.html'/}

<h3>&{'web.admin.diff'}: ${page.title} (&{'web.admin.revision'} ${revision})</h3>
<p class="muted">&{'web.admin.diff.help'}</p>

#{list diff.split('\n?diff --git '), as:'change'}
  #{if change}
  %{change = change.readLines()}%
  <h4>${change[0].replaceFirst('.*? b/', '')}</h4>
  <pre>${change[1..-1].grep{!it.startsWith('index ') && !it.startsWith('---') && !it.startsWith('+++')}.join('\n')}</pre>
  #{/if}
#{/list}

