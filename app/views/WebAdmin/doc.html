#{extends 'Web/layout.html'/}
#{set 'title'}&{'web.admin.doc'}#{/set}
%{demoPage = models.WebPage.ROOT.children()[0]}%

<h1>${title}</h1>

<p>
  Структура меню сайта описывается с помощью иерархии папок, где каждая папка соответствует странице, адрес которой формируется из пути к этой папке.
</p>

<p>
  Внутри каждой папки располагаются файлы, с помощью которых она отображается. Это файлы <b>.html</b> для содержания, картинки, <b>pdf</b>-файлы для скачивания и т.п.
</p>

<p>
  Есть два варианта редактирования сайта:
</p>
<ul>
  <li><a href="#advanced">Для вебмастера</a>, знающего HTML, с прямым доступом к файлам и неограниченными возможностями</li>
  <li><a href="#basic">Для редактора</a>, делающего более простые изменения через веб-интерфейс</li>
</ul>

<p>В любом случае, все изменения производятся в тестовой среде, где можно удостоверится в их правильности.</p>
<p>
  Затем, и вебмастер и редактор должны <a href="@{WebAdmin.status()}">опубликовать</a> свои изменения, чтобы они попали в боевую среду.
  При этом желательно оставить также комментарий, кратко описывающий причину сделанных изменений.
  После публикации изменения появляются в боевой среде в течение 5-10 минут.
</p>

<a name="basic"></a>
#{include 'WebAdmin/doc-basic.html'/}

<a name="advanced"></a>
<h2>Как все устроено</h2>

<p>В папке каждой страницы должен быть файл <i>metadata.properties</i>, описывающий свойства страницы.</p>

<h3>metadata.properties</h3>

<p>Возможны следующие параметры (все опциональны):</p>

<ul>
  #{list models.MetadataField.ALL, as:'field'}
    <li><b>${field.name}</b>: &{'web.metadata.' + field.name}</li>
  #{/list}
</ul>

<p>Пример содержания файла:</p>
<pre>${demoPage.loadFile("metadata.properties")}</pre>

<h3>Шаблоны</h3>

<p>Доступные шаблоны страниц и их заменяемые части:</p>

<ul>
  #{list templates, as:'template'}
    <li>
      <b>${template.name}</b> ${template.description} ${template.parts}
    </li>
  #{/list}
</ul>

<h3>Содержание</h3>

<p>
  Содержание страницы формируется с помощью указанного в мета-данных шаблона и последующего замещения его частей на содержание соответствующих <b>.html</b> файлов в папке страницы.
  Например, если шаблон не указан либо указан шаблон <b>custom</b>, то он описывает всего одну заменяемую часть - <b>content</b>. Следовательно, в папке надо разместить файл
  с названием <b>content.html</b>, содержание которого будет отображено в середине страницы, между шапкой и подвалом. Если поддерживаемые шаблоном части не найдены в папке страницы,
  то вместо них ничего не будет вставлено.
</p>

<p>
  Второй пример: если надо поменять главный баннер на странице <i>/individual</i> (использующей шаблон <b>frontpage</b>), то веб-мастер (залогинившись на сайт)
  на этой странице может навести мышкой на этот баннер и увидеть название файла с его содержанием красным цветом, в данном случае - <b>main-banner</b>.
  Следовательно, изменение баннера происходит в файле <b>/individual/main-banner.html</b>.
</p>

<h3>Использование HTML/CSS</h3>

<p>
  В большинстве случаев достаточно писать простой HTML и использовать стандартные тэги.
  Для базового CSS используется проект <a href="http://twitter.github.io/bootstrap/base-css.html#typography">Twitter Bootstrap</a>, так что вся типография, описанная там, применима и здесь.
</p>

<hr>

<h1>Заголовок 1</h1>
<h2>Заголовок 2</h2>
<h3>Заголовок 3 <span class="highlighted">и выделение</span></h3>

<p>
  Абзац текста <small>и маленькая вставка, в том числе в заголовках</small>.<br>
  Некоторый текст <span class="highlighted">можно выделить</span> или <span class="muted">наоборот</span>.
</p>

<h4>Списки</h4>

<ul>
  <li>Элемент списка 1</li>
  <li>Элемент списка 2</li>
</ul>

<ol>
  <li>Элемент списка</li>
  <li>Элемент списка</li>
</ol>

<h4>Таблицы</h4>

<div class="row-fluid">
  <div class="span6">
    %{tableClass = 'table'}%
    #{include 'WebAdmin/demo-table.html'/}
  </div>
  <div class="span6">
    %{tableClass = 'table table-condensed'}%
    #{include 'WebAdmin/demo-table.html'/}
  </div>
</div>
<div class="row-fluid">
  <div class="span6">
    %{tableClass = 'table table-bordered'}%
    #{include 'WebAdmin/demo-table.html'/}
  </div>
  <div class="span6">
    %{tableClass = 'table table-striped'}%
    #{include 'WebAdmin/demo-table.html'/}
  </div>
</div>
<div class="row-fluid">
  <div class="span12">
    %{tableClass = 'table table-bordered table-striped table-condensed'}%
    #{include 'WebAdmin/demo-table.html'/}
  </div>
</div>

<h4>Ссылки</h4>

<a href="${demoPage.path}">Обычная ссылка</a><br>
<a class="chevron" href="${demoPage.path}">Ссылка со стрелкой</a><br>

<hr>

<h3>Картинки и файлы для скачивания</h3>

<p>
  В эти же папки можно класть картинки и любые другие файлы и ссылаться на них из содержания только по названию.
</p>
<pre>&lt;img src="filename.png"&gt;</pre>

<p>
  К файлам для скачивания будет автоматически добавлена иконка и размер файла
</p>

<pre>&lt;a href="report.pdf"&gt;Скачайте отчёт&lt;/a&gt;</pre>

<p>Будет выглядеть так: <a class="download pdf" href="#">Скачайте отчёт (PDF, 1.3 Mb)</a></p>


<p>
  В данный момент только файлы <b>${models.WebPage.ALLOWED_FILE_TYPES}</b> будут доступны для скачивания.
</p>


<h3>Формы</h3>

<p>Для создания веб-формы надо создать страницу с шаболоном <i>form</i> и описать поля формы в файле <i>form.html</i>.</p>

<p>Поля описываются с помощью стандартных HTML5 полей, например:</p>

<pre>&lt;input type="email" name="Э-почта"&gt;
&lt;textarea rows="4" name="Комментарии"&gt;&lt;/textarea&gt;
</pre>

<p>
  Необходимо использовать всегда точный атрибут <b>type</b> (для валидации). Атрибут <b>name</b> будет отображен пользователю и будет использован также при посылке заполненной формы получателю.
</p>

<p>Получател(и) формы определяются в metadata.properties, поле <i>email</i>.</p>

<p>Если необходимо добавить к форме также выбор отделения, надо добавить поле <i>branchSelection: true</i>.</p>

<p>Также, можно добавить дополнительных получателей для каждого офиса с помощью поля <i>email.Название-Офиса</i>.</p>